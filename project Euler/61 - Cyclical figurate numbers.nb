(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11910,        331]
NotebookOptionsPosition[     11443,        310]
NotebookOutlinePosition[     11784,        325]
CellTagsIndexPosition[     11741,        322]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["61 - Cyclical figurate numbers", "BOOK TITLE",
 CellChangeTimes->{{3.6541960050212007`*^9, 3.6541960061816993`*^9}}],

Cell["\<\


Triangle, square, pentagonal, hexagonal, heptagonal, and octagonal numbers \
are all figurate (polygonal) numbers and are generated by the following \
formulae:
Triangle \t  \tP3,n=n(n+1)/2 \t  \t1, 3, 6, 10, 15, ...
Square \t  \t\tP4,n=n2 \t  \t1, 4, 9, 16, 25, ...
Pentagonal \t  \tP5,n=n(3n\[Minus]1)/2   \t1, 5, 12, 22, 35, ...
Hexagonal \t  \tP6,n=n(2n\[Minus]1) \t  \t1, 6, 15, 28, 45, ...
Heptagonal \t  \tP7,n=n(5n\[Minus]3)/2  \t1, 7, 18, 34, 55, ...
Octagonal \t  \tP8,n=n(3n\[Minus]2) \t  \t1, 8, 21, 40, 65, ...

The ordered set of three 4-digit numbers: 8128, 2882, 8281, has three \
interesting properties.

    The set is cyclic, in that the last two digits of each number is the \
first two digits of the next number (including the last number with the first).
    Each polygonal type: triangle (P3,127=8128), square (P4,91=8281), and \
pentagonal (P5,44=2882), is represented by a different number in the set.
    This is the only set of 4-digit numbers with this property.

Find the sum of the only ordered set of six cyclic 4-digit numbers for which \
each polygonal type: triangle, square, pentagonal, hexagonal, heptagonal, and \
octagonal, is represented by a different number in the set.
\
\>", "Text",
 CellChangeTimes->{{3.654196013653644*^9, 3.6541960212619677`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p3", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"n", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "+", "1"}], ")"}], "/", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p4", "[", "n_Integer", "]"}], ":=", 
   SuperscriptBox["n", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p5", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"n", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", "n"}], "-", "1"}], ")"}], "/", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p6", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"n", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "n"}], "-", "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p7", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"n", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"5", "n"}], "-", "3"}], ")"}], "/", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"p8", "[", "n_Integer", "]"}], ":=", 
    RowBox[{"n", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", "n"}], "-", "2"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"isCyclic", "[", "list_", "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tests", "=", 
          RowBox[{"{", "}"}]}], ",", "i", ",", 
         RowBox[{"len", "=", 
          RowBox[{"Length", "[", "list", "]"}]}], ",", 
         RowBox[{"digitList", "=", 
          RowBox[{"Map", "[", 
           RowBox[{"IntegerDigits", ",", "list"}], "]"}]}], ",", "result"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"digitList", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "\[Equal]", 
           RowBox[{"digitList", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{
               RowBox[{"-", "2"}], ";;", 
               RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"tests", ",", "True"}], "]"}], ",", 
          RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<", "len"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"digitList", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{
                  RowBox[{"-", "2"}], ";;", 
                  RowBox[{"-", "1"}]}]}], "]"}], "]"}], "\[Equal]", 
              RowBox[{"digitList", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"i", "+", "1"}], ",", 
                 RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"tests", ",", "True"}], "]"}], ",", 
             RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"tests", ",", "False"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"StringForm", "[", 
  RowBox[{"\"\<{`1`,`2`,0,0,0,`3`}\>\"", ",", 
   RowBox[{"(*", "1", "*)"}], 
   RowBox[{"Dynamic", "[", "i3", "]"}], ",", 
   RowBox[{"(*", "2", "*)"}], 
   RowBox[{"Dynamic", "[", "i4", "]"}], ",", 
   RowBox[{"(*", "3", "*)"}], 
   RowBox[{"Dynamic", "[", "i8", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringForm", "[", 
  RowBox[{"\"\<``\>\"", ",", 
   RowBox[{"Dynamic", "[", "targets", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"targets", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i8", "=", "19"}], ",", "True", ",", 
    RowBox[{"i8", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"num8", "=", 
      RowBox[{"p8", "[", "i8", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i3", "=", "45"}], ",", "True", ",", 
       RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"num3", "=", 
         RowBox[{"p3", "[", "i3", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"IntegerDigits", "[", "num3", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "2"}], "]"}], "]"}], "\[Equal]", 
           RowBox[{
            RowBox[{"IntegerDigits", "[", "num8", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"-", "2"}], ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"targets", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "=", "num3"}], ";", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{"targets", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "=", "num8"}], ";"}], 
            "*)"}], 
           RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerLength", "[", "num3", "]"}], ">", "4"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i4", "=", "32"}], ",", "True", ",", 
          RowBox[{"i4", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"num4", "=", 
            RowBox[{"p4", "[", "i3", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"IntegerDigits", "[", "num4", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "2"}], "]"}], "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"IntegerDigits", "[", "num3", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"-", "2"}], ";;", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"targets", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "=", "num4"}], ";", 
              RowBox[{
               RowBox[{"targets", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], "=", "num8"}], ";", 
              RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"IntegerLength", "[", "num4", "]"}], ">", "4"}], ",", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"IntegerDigits", "[", "num8", "]"}], ">", "4"}], ",", 
       RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"targets", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], ">", "0"}], ",", 
       RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.654196031340184*^9, 3.654196085340483*^9}, {
   3.6541961740422907`*^9, 3.654196279947308*^9}, {3.6541976631150007`*^9, 
   3.654197748396518*^9}, 3.65419786347992*^9, {3.6541979928176994`*^9, 
   3.6541983487807126`*^9}, {3.6541983810372524`*^9, 3.654198703674673*^9}, {
   3.6541987346694717`*^9, 3.6541989681269464`*^9}, {3.654198998209072*^9, 
   3.6541990027297883`*^9}}],

Cell[BoxData[
 InterpretationBox["\<\"{\\!\\(\\*DynamicBox[ToBoxes[i3, \
StandardForm]]\\),\\!\\(\\*DynamicBox[ToBoxes[i4, StandardForm]]\\),0,0,0,\\!\
\\(\\*DynamicBox[ToBoxes[i8, StandardForm]]\\)}\"\>",
  StringForm["{`1`,`2`,0,0,0,`3`}", 
   Dynamic[$CellContext`i3], 
   Dynamic[$CellContext`i4], 
   Dynamic[$CellContext`i8]],
  Editable->False]], "Output",
 CellChangeTimes->{{3.6541986452985725`*^9, 3.654198650408018*^9}, 
   3.6541988364375286`*^9, 3.6541989430394783`*^9, 3.654199007807979*^9}],

Cell[BoxData[
 InterpretationBox["\<\"\\!\\(\\*DynamicBox[ToBoxes[targets, \
StandardForm]]\\)\"\>",
  StringForm["``", 
   Dynamic[$CellContext`targets]],
  Editable->False]], "Output",
 CellChangeTimes->{{3.6541986452985725`*^9, 3.654198650408018*^9}, 
   3.6541988364375286`*^9, 3.6541989430394783`*^9, 3.6541990078236046`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{775, 561},
WindowMargins->{{287, Automatic}, {Automatic, 54}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"MyBook.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 122, 1, 80, "BOOK TITLE"],
Cell[705, 25, 1305, 27, 418, "Text"],
Cell[CellGroupData[{
Cell[2035, 56, 8539, 229, 812, "Input"],
Cell[10577, 287, 505, 10, 31, "Output"],
Cell[11085, 299, 330, 7, 31, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
